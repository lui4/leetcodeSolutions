public class NearestExitFromEntranceMaze {
    int[][] directions;
    char[][] maze;
    public int nearestExit(char[][] maze, int[] entrance) {
        directions = new int[][]{{0, 1}, {1, 0}, {0, -1}, {-1, 0}};
        this.maze = maze;

        return dfs(entrance[0], entrance[1], 0, entrance);
    }

    public int dfs(int positionX, int positionY, int steps, int[] entrance) {
        if (isExit(positionX, positionY, entrance)) {
            System.out.println(steps);
            return steps;
        }

        maze[positionX][positionY] = '+';

        int ans = Integer.MAX_VALUE;

        boolean newDirectionExplored = false;
        for (int[] direction : directions) {
            int newX = positionX + direction[0];
            int newY = positionY + direction[1];

            if (isValid(newX, newY)) {
                int furtherSteps = dfs(newX, newY, steps + 1, entrance);
                if (furtherSteps == -1 ) {continue;}
                ans = Math.min(furtherSteps, ans);
                newDirectionExplored = true;
            }
        }

        return newDirectionExplored ? ans : -1;
    }

    public boolean isValid(int x, int y) {
        return x >= 0 && x < maze.length && y >= 0 && y < maze[0].length && maze[x][y] == '.';
    }
    public boolean isExit(int positionX, int positionY, int[] entrance) {
        return (positionX == maze.length - 1 || positionX == 0 || positionY == 0 || positionY == maze[0].length - 1) && !(entrance[0] == positionX && entrance[1] == positionY);
    }

    public static void main(String[] args) {
        NearestExitFromEntranceMaze ne = new NearestExitFromEntranceMaze();
        System.out.println(ne.nearestExit(new char[][]{{'.','+','+','.','+','+','+','.','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','+','.','+','+','+','+','+','.','+','+'},
                        {'+','.','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','.','+','+','+'},
                        {'+','.','+','+','+','.','+','+','+','.','+','+','+','+','.','+','+','+','.','.','.','+','+','+','+','+','.','+','+','+','+','+','.','+','.','+','+','+'},
                        {'+','+','.','.','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','.','.','+','+','.','.','.','+','+','+','.','+','+','+','+','+','+','.'},
                        {'+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.','.','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.'},
                        {'+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','.','.','+','+','+','.','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+'},
                        {'+','.','+','+','.','+','+','.','.','+','.','+','+','+','+','+','+','+','+','+','.','.','+','.','+','+','+','+','+','+','+','.','.','+','+','.','+','+'},
                        {'+','+','.','+','+','+','+','+','+','.','+','+','.','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','.','.','+','.','+','+'},
                        {'+','+','+','+','+','.','+','+','+','+','+','+','+','.','+','+','+','+','+','+','.','.','.','+','+','+','+','+','+','+','.','+','.','.','+','+','+','+'},
                        {'+','.','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','.','.','+','.','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+'},
                        {'+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','.','+','.','+','+','+','+','+','.'},
                        {'+','+','+','+','+','.','.','.','+','+','+','+','+','+','.','+','+','.','+','+','+','+','+','+','+','+','+','+','+','.','+','+','.','+','.','+','+','+'},
                        {'+','+','.','.','.','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','.','+','+','.','+','+','+','+','.','.','+','+','.','.','+'},
                        {'.','+','+','+','+','+','.','+','.','+','+','+','+','.','+','+','+','+','+','.','+','+','+','+','+','+','+','.','+','+','+','+','+','+','.','+','+','+'},
                        {'+','+','+','.','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','.','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','.'},
                        {'+','+','.','.','+','+','.','+','+','+','+','.','+','+','+','+','+','+','.','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+'},
                        {'+','+','+','+','+','+','+','+','+','+','+','.','+','+','+','.','+','+','+','.','+','+','+','.','+','+','.','+','+','+','+','+','.','.','+','+','.','+'},
                        {'+','+','+','.','+','.','+','.','+','+','.','+','+','.','.','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','.','+','.'},
                        {'+','+','+','+','.','+','.','+','+','.','+','+','+','+','+','+','.','+','+','+','+','.','+','+','+','+','+','.','+','+','.','+','+','.','.','.','+','.'},
                        {'.','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','.','+','+','.','.','+','+','+','.','+','+','+','+'},
                        {'+','+','+','+','.','.','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+'},
                        {'+','+','+','+','+','.','+','+','.','+','+','+','+','.','+','+','+','+','+','+','.','+','+','+','+','+','.','+','+','+','+','.','+','+','.','+','+','+'},
                        {'+','+','+','+','.','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','+','.'},{'.','.','+','+','+','+','.','+','+','.','+','+','+','+','.','+','.','.','.','+','+','.','+','+','+','+','.','+','+','+','+','+','.','+','+','+','+','+'},{'.','+','+','.','+','+','.','+','+','.','+','+','+','+','+','.','+','+','+','.','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+'},{'+','+','+','+','+','+','+','+','+','+','.','.','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','.','+','+','+','+','+','+'},{'+','+','.','+','.','+','+','+','+','+','+','.','.','+','+','+','+','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','.','+','+'},{'+','+','+','.','.','+','.','+','+','+','+','+','+','+','+','+','+','.','+','+','+','.','+','+','+','+','+','+','+','+','.','.','+','+','.','.','+','+'},{'.','+','+','+','.','+','.','+','+','+','+','+','+','+','+','+','+','.','+','.','+','.','.','.','+','+','+','.','+','.','+','+','.','.','+','+','.','+'},{'.','+','+','.','+','+','+','+','.','.','.','.','+','+','.','+','+','+','+','+','.','.','.','.','.','.','.','+','.','+','+','+','+','+','+','+','+','+'},{'+','+','+','+','+','.','+','.','+','+','+','+','.','+','+','+','.','+','.','+','.','.','+','.','+','+','+','.','+','+','+','+','+','.','+','+','+','+'},{'.','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','+','+','+','.','+','.','.','+','.','+','+','+','+','+','+','+','.','+','+','+'},{'+','+','+','.','+','.','.','+','+','.','+','+','.','.','+','+','+','+','+','+','.','+','.','.','.','+','+','+','+','+','+','+','.','+','+','.','+','+'},{'+','+','+','.','+','+','+','+','+','.','+','+','+','.','+','+','+','.','.','+','+','.','.','+','.','.','+','+','+','+','+','.','.','+','+','+','+','+'},{'+','+','+','+','+','.','+','+','.','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','+','+'},{'+','.','+','+','+','+','+','+','+','+','.','.','+','+','+','+','+','+','+','+','+','+','+','+','.','.','+','+','.','+','+','+','+','+','+','+','+','.'},{'+','+','.','.','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','.','.','+','+','+','.','+','+','+','+','+','.','+','.','+','+','+','+','+'},{'+','+','+','.','+','+','+','+','.','+','+','+','+','+','+','.','+','+','+','.','.','.','+','.','.','.','+','+','+','+','+','+','+','+','+','+','+','+'},{'.','+','+','+','+','.','+','+','.','+','+','+','+','+','+','.','+','+','+','+','+','.','+','+','.','+','+','+','+','+','+','+','+','+','+','.','+','+'},{'+','+','+','+','+','.','+','+','+','+','+','.','+','+','+','.','+','+','.','.','.','+','.','+','.','+','.','.','+','+','+','+','+','+','+','+','.','+'},{'+','+','+','+','+','+','.','.','+','+','+','+','.','+','.','+','+','+','.','+','+','.','+','+','.','.','+','+','+','.','.','+','+','+','+','+','+','+'},{'.','+','+','+','+','+','+','+','.','+','+','+','+','+','+','+','+','+','.','+','.','.','+','+','.','.','+','+','.','+','+','+','+','+','+','+','.','+'},{'+','+','.','+','+','+','+','+','+','+','+','+','+','+','.','.','.','+','+','+','+','+','.','+','.','+','+','+','+','.','+','.','+','+','.','+','+','.'}}
                ,new int[]{28,23}));
    }
}
